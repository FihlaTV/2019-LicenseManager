# Licensoft-Web API
This document will explain how is used the Licensoft-Web API.


## Index
* [LogIn](#login)
* [LogOut](#logout)
* [Register](#register)
* [Get All Users](#get-all-users)
* [Add Card](#add-card)
* [Add Subscription](#add-subscription)
* [Buy Product](#buy-product)
* [Get Products](#get-products)
* [Get Specific Product](#get-specific-product)
* [Post Product](#post-product)
* [Edit  Product](#edit-product)
* [Delete Product](#delete-product)
* [Post image (on a Product)](#postImage)
* [Get image (of a Product)](#getImage)  
* [Get License by Product and Serial](#getLicSerialProduct)
* [Get Licenses of User](#get-licenses-of-user)
* [Set cancelAtEnd of License](#set-cancelatend-of-license)
* [Get Licenses of User and Product](#getLicUserProduct)
* [Check License (Licencheck)](#checkLicense)


## Authorization
Many of the requests will need Basic Authentication (with role USER or ADMIN) . If not, will respond with code 401 or 403.
Example: Postman
![Postman Basic Auth](images/postmanAuth.jpg)

## Login
Make the request without params, just including in Authorization UserName and Password.
- **URL**  
   `/api/logIn`
- **Method**  
   `GET`
- **Data Params**

- **Required role**:  
   None
   
- **Authorization:**
	Basic Auth 
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:


## LogOut
Same as LogIn.
- **URL**  
   `/api/logOut`
- **Method**  
   `GET`
- **Data Params**

- **Required role**:  
   None
   
- **Authorization:**
	Basic Auth 
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:

  ```json
  {
  }
  ```

## Register
- **URL**  
   `/api/register/{user}/{pass}/{pass2}`
- **Method**  
   `POST`
- **Data Params**
Path Variables:
	* String userName
	* String pass
	* String pass2 (must be the same as pass) 
- **Required role**:  
   None
   
- **Authorization:**
	None 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  - 
## Get All Users
- **URL**  
   `/api/users`
- **Method**  
   `GET`
- **Data Params**

- **Required role**:  
   Admin.
   
- **Authorization:**
	Basic Auth 
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:

  ```json
  {
    "content": [
	    {
			"id": 1,
			"name": "admin",
			"passwordHash": "$2a$10$Pp35/Hj9h8lJPj2qSD.BW.ddKbXyT3vSW/modh9Bj9RDNriEg4CoO",
			"roles": ["ROLE_USER"]
		  }
	],
		"pageable": {
			"sort": {
			"sorted": false,
			"unsorted": true,
			"empty": true
			},
			"offset": 0,
			"pageSize": 20,
			"pageNumber": 0,
			"unpaged": false,
			"paged": true
		},
		"totalElements": 1,
		"last": true,
		"totalPages": 1,
		"size": 20,
		"number": 0,
		"sort": {
			"sorted": false,
			"unsorted": true,
			"empty": true
		},
		"numberOfElements": 1,
		"first": true,
		"empty": false
	}

## Add Card
- **URL**  
   `/api/user/addCard/{tokenId}`
- **Method**  
   `POST`
- **Data Params**
Path Variables:
	* String tokenId => Token auto-generated by StripeElements that has Credit Card Information
	[See Info](./StripeIntegration.md)
- **Required role**:  
    * Admin
    * User
   
- **Authorization:**
	Basic Auth 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"id": 1,
	"name": "customer",
	"passwordHash": "$2a$10$8B93APA0H7xmlzcAGu0Ow.9oTww0b4FKWnyWDbd39J2DVVbtiTGeq",
	"roles": [
		"ROLE_USER"
	]
}

  

##  Add Subscription
- **URL**  
   `/api/user/{productName}/{typeSubs}/{userName}/addSubscription/renewal/{automaticRenewal}`
- **Method**  
   `PUT`
- **Data Params**
Path Variables:
	* String productName
	* String typeSubs (D,M,A,L)
	* String userName (User that is going to subscribe)
	* boolean automaticRenewal 
- **Required role**:  
    * Admin
    * User
   
- **Authorization:**
	Basic Auth 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
	{
    "id": 15,
    "serial": "04b4f363-08e4-4726-aa66-47f7ff86c9cb",
    "active": true,
    "type": "D",
    "product": {
        "name": "hw",
        "productStripeId": "prod_GEsq8txRlM9Ng2",
        "typeSubs": [
            "A",
            "M",
            "D"
        ],
        "description": "THIS IS A DESCRIPTION ---------------------------------------------------------------------------------.",
        "webLink": null,
        "photoAvailable": false,
        "photoSrc": "",
        "plansPrices": {
            "A": 1500.0,
            "D": 0.63,
            "M": 150.0
        },
        "sku": null,
        "active": true
    },
    "startDate": "2020-02-18T19:38:15.763+0000",
    "endDate": "2020-02-19T19:38:15.763+0000",
    "owner": "C1",
    "cancelAtEnd": true
    }


## Buy Product
- **URL**  
   `/api/user/{userName}/buy/{productName}/{token}`
- **Method**  
   `PUT`
- **Data Params**
	* String userName (User that is going to buy the product)
	* String productName
	* String token ( Token of Card Info created with StripeElements on the frontend)
- **Required role**:  
    * Admin
    * User
   
- **Authorization:**
	Basic Auth 
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```
  {
	"id": 15,
	"serial": "2f4664a5-35ce-4f38-b5ce-b7d29b7e7c40",
	"active": true,
	"type": "L",
	"product": {
		"name": "Photoshop",
		"productStripeId": "prod_Gfjc8kKSdjVwwp",
		"typeSubs": [
		"L"
		],
		"description": "...",
		"webLink": "www.photoshop.com",
		"photoAvailable": false,
		"photoSrc": "",
		"plansPrices": {
		"L": 1500.0
		},
		"sku": "sku_Gfjcck60yqQGnR",
		"active": true
		},
	"startDate": "2020-02-18T19:54:10.940+0000",
	"endDate": null,
	"owner": "C1",
	"cancelAtEnd": false
	}


## Get Products
- **URL**  
   `/api/product/all`
- **Method**  
   `GET`
- **Data Params**
	* *Optional* String search

- **Required role**:  
	None
   
- **Authorization:**
	None
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"content": [
			{
			"name": "Photoshop",
			"productStripeId": "prod_Gfjc8kKSdjVwwp",
			"typeSubs": [
			"L"
			],
			"description": "...",
			"webLink": "www.photoshop.com",
			"photoAvailable": false,
			"photoSrc": "",
			"plansPrices": {
			"L": 1500.0
			},
			"sku": "sku_Gfjcck60yqQGnR",
			"active": true
			},
			{
			"name": "sw",
			"productStripeId": "prod_GEsqozxWp3psL6",
			"typeSubs": [
			"A",
			"M",
			"D"
			],
			"description": "...",
			"webLink": "www.linkSW.com",
			"photoAvailable": true,
			"photoSrc": "assets/logo.jpg",
			"plansPrices": {
			"A": 1500.0,
			"D": 0.63,
			"M": 150.0
			},
			"sku": null,
			"active": true
			},
			{
			"name": "hw",
			"productStripeId": "prod_GEsq8txRlM9Ng2",
			"typeSubs": [
			"A",
			"M",
			"D"
			],
			"description": "THIS IS A DESCRIPTION ---------------------------------------------------------------------------------.",
			"webLink": null,
			"photoAvailable": false,
			"photoSrc": "",
			"plansPrices": {
			"A": 1500.0,
			"D": 0.63,
			"M": 150.0
			},
			"sku": null,
			"active": true
			}
	],
	"pageable": {
	"sort": {
	"sorted": false,
	"unsorted": true,
	"empty": true
	},
	"offset": 0,
	"pageNumber": 0,
	"pageSize": 20,
	"paged": true,
	"unpaged": false
	},
	"totalElements": 3,
	"totalPages": 1,
	"last": true,
	"size": 20,
	"number": 0,
	"sort": {
	"sorted": false,
	"unsorted": true,
	"empty": true
	},
	"numberOfElements": 3,
	"first": true,
	"empty": false
	}

## Get specific Product
- **URL**  
   `/api/product/{productName}`
- **Method**  
   `GET`
- **Data Params**
	* String productName

- **Required role**:  
    None
   
- **Authorization:**
	None
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"name": "hw",
	"productStripeId": "prod_GEsq8txRlM9Ng2",
	"typeSubs": [
	"A",
	"M",
	"D"
	],
	"description": "THIS IS A DESCRIPTION ---------------------------------------------------------------------------------.",
	"webLink": null,
	"photoAvailable": false,
	"photoSrc": "",
	"plansPrices": {
	"A": 1500.0,
	"D": 0.63,
	"M": 150.0
	},
	"sku": null,
	"active": true
	}

## Post Product
- **URL**  
   `/api/product/`
- **Method**  
   `POST`
- **Data body**
	* Product product

- **Required role**:  
	* Admin
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"name": "new",
	"productStripeId": "prod_Gl8legtSVAHdRY",
	"typeSubs": [
		"A",
		"M",
		"D"
	],
	"description": "Description",
	"webLink": null,
	"photoAvailable": false,
	"photoSrc": "",
	"plansPrices": {
		"A": 1500.0,
		"D": 0.63,
		"M": 150.0
	},
	"sku": null,
	"active": true
	}
## Edit Product
- **URL**  
   `/api/product/`
- **Method**  
   `PUT`
- **Data body**
	* Product product

- **Required role**:  
	* Admin
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"name": "new",
	"productStripeId": "prod_Gl8legtSVAHdRY",
	"typeSubs": [
		"A",
		"M",
		"D"
	],
	"description": "Description updated",
	"webLink": null,
	"photoAvailable": false,
	"photoSrc": "",
	"plansPrices": {
		"A": 1500.0,
		"D": 0.63,
		"M": 150.0
	},
	"sku": null,
	"active": true
	}

## Delete Product
- **URL**  
   `/api/product/{productName}`
- **Method**  
   `DELETE`
- **Data params**
	* String productName

- **Required role**:  
	* Admin
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**:
  ```json
  {
	"name": "new",
	"productStripeId": "prod_Gl8legtSVAHdRY",
	"typeSubs": [
		"A",
		"M",
		"D"
	],
	"description": "Description",
	"webLink": null,
	"photoAvailable": false,
	"photoSrc": "",
	"plansPrices": {
		"A": 1500.0,
		"D": 0.63,
		"M": 150.0
	},
	"sku": null,
	"active": true
	}

## Post image (on a Product) <a name="postImage"></a>
- **URL**  
   `/api/product/{productName}/image`
- **Method**  
   `POST`
- **Data body**
	* Multipartfile file (jpg)
- **Data params**
	* String productName
- **Required role**:  
	* Admin
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: File Preview

## Get image (of a Product) <a name="getImage"></a>
- **URL**  
   `/api/product/{productName}/image`
- **Method**  
   `GET`
- **Data params**
	* String productName
- **Required role**:  
	None
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: File Preview


## Get Licenses of Product
- **URL**  
   `/api/licenses/product/{productName}`
- **Method**  
   `GET`
- **Data params**
	* String productName
- **Required role**:  
	* Admin
	* User
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  ```json
  {
    "content": [
        {
            "id": 8,
            "serial": "XX-X1",
            "active": false,
            "type": "A",
            "product": {
                "name": "sw",
                "productStripeId": "prod_GEsqozxWp3psL6",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "...",
                "webLink": "www.linkSW.com",
                "photoAvailable": true,
                "photoSrc": "assets/logo.jpg",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": null,
            "endDate": null,
            "owner": null,
            "cancelAtEnd": false
        }
    ],
    "pageable": {
        "sort": {
            "sorted": false,
            "unsorted": true,
            "empty": true
        },
        "offset": 0,
        "pageNumber": 0,
        "pageSize": 20,
        "paged": true,
        "unpaged": false
    },
    "totalElements": 1,
    "totalPages": 1,
    "last": true,
    "size": 20,
    "number": 0,
    "sort": {
        "sorted": false,
        "unsorted": true,
        "empty": true
    },
    "numberOfElements": 1,
    "first": true,
    "empty": false
	}

## Get License by Serial & Product  <a name="getLicSerialProduct"></a>
- **URL**  
   `/api/licenses/{serial}/{productName}`
- **Method**  
   `GET`
- **Data params**
	* String productName
	* String serial
- **Required role**:  
	* Admin
	* User
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  ```json
  {
    "id": 8,
    "serial": "XX-X1",
    "active": false,
    "type": "A",
    "product": {
        "name": "sw",
        "productStripeId": "prod_GEsqozxWp3psL6",
        "typeSubs": [
            "A",
            "M",
            "D"
        ],
        "description": "...",
        "webLink": "www.linkSW.com",
        "photoAvailable": true,
        "photoSrc": "assets/logo.jpg",
        "plansPrices": {
            "A": 1500.0,
            "D": 0.63,
            "M": 150.0
        },
        "sku": null,
        "active": true
    },
    "startDate": null,
    "endDate": null,
    "owner": null,
    "cancelAtEnd": false
  }

## Get Licenses of User
- **URL**  
   `/api/licenses/{userName}`
- **Method**  
   `GET`
- **Data params**
	* String userName
- **Required role**:  
	* Admin
	* User
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  ```json
  {
    "content": [
        {
            "id": 10,
            "serial": "XX-X3",
            "active": true,
            "type": "M",
            "product": {
                "name": "sw",
                "productStripeId": "prod_GEsqozxWp3psL6",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "...",
                "webLink": "www.linkSW.com",
                "photoAvailable": true,
                "photoSrc": "assets/logo.jpg",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": "2020-02-18T20:39:26.000+0000",
            "endDate": "2020-03-18T20:39:26.000+0000",
            "owner": "C1",
            "cancelAtEnd": false
        },
        {
            "id": 11,
            "serial": "XX-X4",
            "active": true,
            "type": "D",
            "product": {
                "name": "sw",
                "productStripeId": "prod_GEsqozxWp3psL6",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "...",
                "webLink": "www.linkSW.com",
                "photoAvailable": true,
                "photoSrc": "assets/logo.jpg",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": "2020-02-18T20:39:26.000+0000",
            "endDate": "2020-02-19T20:39:26.000+0000",
            "owner": "C1",
            "cancelAtEnd": false
        },
        {
            "id": 13,
            "serial": "XX-X2",
            "active": true,
            "type": "M",
            "product": {
                "name": "hw",
                "productStripeId": "prod_GEsq8txRlM9Ng2",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "THIS IS A DESCRIPTION ---------------------------------------------------------------------------------.",
                "webLink": null,
                "photoAvailable": false,
                "photoSrc": "",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": "2020-02-18T20:39:26.000+0000",
            "endDate": "2020-03-18T20:39:26.000+0000",
            "owner": "C1",
            "cancelAtEnd": false
        }
    ],
    "pageable": {
        "sort": {
            "sorted": false,
            "unsorted": true,
            "empty": true
        },
        "offset": 0,
        "pageNumber": 0,
        "pageSize": 20,
        "paged": true,
        "unpaged": false
    },
    "totalElements": 3,
    "totalPages": 1,
    "last": true,
    "size": 20,
    "number": 0,
    "sort": {
        "sorted": false,
        "unsorted": true,
        "empty": true
    },
    "numberOfElements": 3,
    "first": true,
    "empty": false
	}

## Set CancelAtEnd of License
Switches ON/OFF the cancelAtEnd attribute of a License (automatic renewal).
- **URL**  
   `/api/licenses/cancelAtEnd/{serial}/{productName}`
- **Method**  
   `PUT`
- **Data params**
	* String productName
- **Required role**:  
	* Admin
	* User
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  ```json
  {
    "id": 9,
    "serial": "XX-X2",
    "active": true,
    "type": "A",
    "product": {
        "name": "sw",
        "productStripeId": "prod_GEsqozxWp3psL6",
        "typeSubs": [
            "A",
            "M",
            "D"
        ],
        "description": "...",
        "webLink": "www.linkSW.com",
        "photoAvailable": true,
        "photoSrc": "assets/logo.jpg",
        "plansPrices": {
            "A": 1500.0,
            "D": 0.63,
            "M": 150.0
        },
        "sku": null,
        "active": true
    },
    "startDate": "2020-02-18T20:39:26.000+0000",
    "endDate": "2021-02-18T20:39:26.000+0000",
    "owner": "Customer",
    "cancelAtEnd": true
	}

## Get Licenses of User&Product  <a name="getLicUserProduct"></a>
- **URL**  
   `/api/licenses/user/{userName}/product/{productName}`
- **Method**  
   `GET`
- **Data params**
	* String userName
	* String productName
- **Required role**:  
	* Admin
	* User
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  ```json
  {
    "content": [
        {
            "id": 10,
            "serial": "XX-X3",
            "active": true,
            "type": "M",
            "product": {
                "name": "sw",
                "productStripeId": "prod_GEsqozxWp3psL6",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "...",
                "webLink": "www.linkSW.com",
                "photoAvailable": true,
                "photoSrc": "assets/logo.jpg",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": "2020-02-18T20:39:26.000+0000",
            "endDate": "2020-03-18T20:39:26.000+0000",
            "owner": "C1",
            "cancelAtEnd": false
        },
        {
            "id": 11,
            "serial": "XX-X4",
            "active": true,
            "type": "D",
            "product": {
                "name": "sw",
                "productStripeId": "prod_GEsqozxWp3psL6",
                "typeSubs": [
                    "A",
                    "M",
                    "D"
                ],
                "description": "...",
                "webLink": "www.linkSW.com",
                "photoAvailable": true,
                "photoSrc": "assets/logo.jpg",
                "plansPrices": {
                    "A": 1500.0,
                    "D": 0.63,
                    "M": 150.0
                },
                "sku": null,
                "active": true
            },
            "startDate": "2020-02-18T20:39:26.000+0000",
            "endDate": "2020-02-19T20:39:26.000+0000",
            "owner": "C1",
            "cancelAtEnd": false
        }
    ],
    "pageable": {
        "sort": {
            "sorted": false,
            "unsorted": true,
            "empty": true
        },
        "offset": 0,
        "pageNumber": 0,
        "pageSize": 20,
        "paged": true,
        "unpaged": false
    },
    "totalElements": 2,
    "totalPages": 1,
    "last": true,
    "size": 20,
    "number": 0,
    "sort": {
        "sorted": false,
        "unsorted": true,
        "empty": true
    },
    "numberOfElements": 2,
    "first": true,
    "empty": false
	}

## Check License ([Licencheck](../LicencheckGuide.md)) <a name="checkLicense"></a>
- **URL**  
   `/licencheck/checkLicense/{productName}/{licenseSerial}`
- **Method**  
   `GET`
- **Data params**
	* String licenseSerial
	* String productName
- **Required role**:  
	None
   
- **Authorization:**
	Basic Auth
 

- **Success Response**
  - **Code**: 200 OK
  - **Content**: 
  
   ```json	  {
	    "id": 10,
	    "serial": "XX-X3",
	    "active": true,
	    "type": "M",
	    "product": {
	        "name": "sw",
	        "productStripeId": "prod_GEsqozxWp3psL6",
	        "typeSubs": [
	            "A",
	            "M",
	            "D"
	        ],
	        "description": "...",
	        "webLink": "www.linkSW.com",
	        "photoAvailable": true,
	        "photoSrc": "assets/logo.jpg",
	        "plansPrices": {
	            "A": 1500.0,
	            "D": 0.63,
	            "M": 150.0
	        },
	        "sku": null,
	        "active": true
	    },
	    "startDate": "2020-02-18T20:39:26.000+0000",
	    "endDate": "2020-03-18T20:39:26.000+0000",
	    "owner": "C1",
	    "cancelAtEnd": false
	}